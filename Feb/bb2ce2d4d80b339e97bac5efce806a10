Police use of automated data analysis to prevent crime in some German states was unconstitutional, a top German court said on Thursday, ruling in favor of critics of software provided by the CIA-backed Palantir Technologies PLTR.N. Provisions regulating the use of the technology in Hesse and Hamburg violate the right to informational self-determination, a statement from the constitutional court said. Hesse has been given a Sept. 30 deadline to rewrite its provisions, while legislation in Hamburg — where the technology was not yet in use — was nullified. "Given the particularly broad wording of the powers, in terms of both the data and the methods concerned, the grounds for interference fall far short of the constitutionally required threshold of an identifiable danger," the court said. However, court president Stephan Harbarth said states had the option "of shaping the legal basis for further processing of stored data files in a constitutional manner." Hesse's State Minister of Interior Peter Beuth said current practices must be made more robust and codified, but welcomed the ruling for recognizing that "police work of the future must deal efficiently with large amounts of data." He said the technology has so far been used, among other things, to investigate the underground network charged with plotting to overthrow the German government in December. Palantir's strategy chief in Europe, Jan Hiesserich, said the U.S.-based company merely provides the software for processing data, not the data itself. "Which data is relevant for investigation in this context is determined exclusively by our customers in accordance with relevant legal provisions," he told the Handelsblatt newspaper. The company did not immediately respond to a Reuters request for comment on Thursday. The German Society for Civil Rights (GFF), which brought the case against police data analysis, said Palantir software used innocent people's data to form suspicions and could also produce errors, affecting people at risk of police discrimination. 